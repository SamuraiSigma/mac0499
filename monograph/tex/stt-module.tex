\chapter{Módulo \textit{Speech to Text} para \textit{Godot}}
\label{cap:stt-module}

Após adquirirmos conhecimento sobre a biblioteca \textit{Pocketsphinx} e a \textit{game engine} \textit{Godot}, chegou o momento de construirmos o módulo de reconhecimento de voz.

Conforme descrito na seção \ref{godotLanguages}, a linguagem \textit{GDScript} é extremamente prática para programar estruturas em um jogo feito em \textit{Godot}. No entanto, às vezes deseja-se otimizar alguma parte crítica através de \textit{C++} ou adicionar uma nova funcionalidade inexistente em \textit{Godot}. Os módulos servem justamente para este objetivo, pois não fazem parte do código essencial da \textit{game engine}.

Este capítulo documenta os passos e decisões de projeto tomados na criação do módulo, a qual chamaremos de \textit{Speech to Text}. Pressupomos que o leitor esteja familiarizado com as instruções para compilação de \textit{Godot}, vistas na seção \ref{godotCompile}.

% ---------------------------------------------------------------------

\section{Primeiros passos}

Antes de começarmos a implementar o módulo em si, precisaremos tomar algumas medidas simples de preparação.

\subsection{Criação do diretório do módulo}

Todos os módulos ativos são encontrados como subdiretórios dentro da pasta \texttt{modules/} no código fonte. Começaremos, portanto, com a criação do diretório \texttt{speech\_to\_text}:

\begin{lstlisting}[language=Bash]
$ cd modules
$ mkdir speech_to_text
$ cd speech_to_text
\end{lstlisting}

% ---------------------------------------------------------------------

\subsection{Adição do pacote \textit{Sphinxbase}}

Usaremos a biblioteca \textit{Pocketsphinx} para realizar o reconhecimento de voz no módulo. Um dos requisitos necessários para seu funcionamento, conforme visto na seção \ref{sphinxCompile}, é o pacote \textit{Sphinxbase}. A seguir, apresentamos instruções para inserir os arquivos essenciais deste pacote no diretório do módulo.

\begin{enumerate}
\item Baixe o pacote \textit{Sphinxbase} em sua versão atual mais estável, a \textbf{5-prealpha}.

\begin{lstlisting}
$ SPHINXURL="https://sourceforge.net/projects/cmusphinx/files"
$ wget $SPHINXURL/sphinxbase/5prealpha/sphinxbase-5prealpha.tar.gz
\end{lstlisting}

\item Extraia e renomeie o pacote baixado.

\begin{lstlisting}
$ tar -xvf sphinxbase-5prealpha
$ mv sphinxbase-5prealpha sphinxbase
\end{lstlisting}

\item Remova arquivos supérfluos, como \texttt{Makefiles}, arquivos de teste e \textit{scripts} de compilação. Estes serviriam para aumentar, desnecessariamente, o tamanho do módulo. Em outras palavras, somente as interfaces e implementações nos pacotes serão mantidas. Veja a listagem \ref{sphinxbaseEssential} para maiores detalhes.

\lstinputlisting[
  language=Bash,
  caption={Remoção de arquivos supérfluos no pacote \textit{Sphinxbase}},
  label={sphinxbaseEssential}]
  {listing/sphinxbase-essential.sh}
\end{enumerate}

% ---------------------------------------------------------------------

\subsection{Adição do pacote \textit{Pocketsphinx}}

Precisamos, também, do pacote \textit{Pocketsphinx} para a biblioteca homônima funcionar. A seguir, apresentamos instruções para inserir os arquivos essenciais deste pacote no diretório do módulo.

\begin{enumerate}
\item Baixe o pacote \textit{Pocketsphinx} em sua versão atual mais estável, a \textbf{5-prealpha}.

\begin{lstlisting}
$ SPHINXURL="https://sourceforge.net/projects/cmusphinx/files"
$ wget $SPHINXURL/pocketsphinx/5prealpha/pocketsphinx-5prealpha.tar.gz
\end{lstlisting}

\item Extraia e renomeie o pacote baixado.

\begin{lstlisting}
$ tar -xvf pocketsphinx-5prealpha
$ mv pocketsphinx-5prealpha pocketsphinx
\end{lstlisting}

\item Remova arquivos supérfluos, isto é, que não sejam interfaces ou implementações. Veja a listagem \ref{pocketsphinxEssential} para maiores detalhes.

\lstinputlisting[
  language=Bash,
  caption={Remoção de arquivos supérfluos no pacote \textit{Pocketsphinx}},
  label={pocketsphinxEssential}]
  {listing/pocketsphinx-essential.sh}
\end{enumerate}

% ---------------------------------------------------------------------

\section{Planejamento}

% ---------------------------------------------------------------------

\section{Implementação}

% ---------------------------------------------------------------------

\section{Divulgação}

Todo o código fonte do módulo \textit{Speech to Text} encontra-se no GitHub do autor \citep{sttModuleGitHub}. O repositório também disponibiliza binários dos editores \textit{Godot} e \textit{templates de exportação} já contendo o módulo \citep{sttModuleDownload}.

\textit{Speech to Text} foi divulgado em dois fóruns de \textit{Godot}, onde obteve algumas poucas aprovações:

\begin{itemize}
\item \textbf{Godot Engine Q\&A} \citep{sttModuleGodotQA}: O site oficial de \textit{Godot} disponibiliza uma seção para perguntas e respostas, onde existe uma subseção para publicação de projetos.

\item \textbf{Godot Developers} \citep{sttModuleGodotDevelopers}: Embora seja mais voltado para jogos produzidos na \textit{game engine}, este fórum possui uma seção para compartilhamento de recursos e ferramentas.
\end{itemize}
